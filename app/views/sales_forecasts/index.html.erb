<script>
	$(document).ready(function()
	{
		$("#myTable").tablesorter();
	}
);
</script>

<h1>フォーキャスト一覧</h1>

<% if $sc_switch %>
<ul class="nav nav-tabs" role="tablist">
	<li<% if @service_center_id.nil? %> class="active" <% end %>>
		<%= link_to 'すべて', sales_forecasts_path %>
	</li>
	<% @service_centers.each do |service_center| %>
	<li<% if service_center.id == @service_center_id.to_i %> class="active" <% end %>>
		<%= link_to service_center.name, {action: :index, sc: service_center.id} %>
	</li>
	<% end %>
</ul>
<% end %>

<table id="myTable" class="table table-striped table-condensed table-hover tablesorter">
  <thead>
    <tr>
    	<% if $sc_switch %>
      <th>SC</th>
      <% end %>
      <th>客層</th>
      <th>状態</th>
      <th>地域</th>
      <th>顧客</th>
      <th>部署</th>
      <th>氏名</th>
      <th>機種</th>
      <th>金額</th>
      <th>予算</th>
      <th>確度</th>
      <th>期待値</th>
      <th>申請時期</th>
      <th>確定時期</th>
      <th>発注時期</th>
      <th>代理店</th>
      <th>状況</th>
      <th>担当</th>
      <th>表示</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @sales_forecasts.each do |sales_forecast| %>
      <tr>
      	<% if $sc_switch %>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= get_attribute(sales_forecast.service_center, :name) %></td>
        <% end %>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= get_attribute(sales_forecast.segment, :name) %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= get_attribute(sales_forecast.status, :name) %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= get_attribute(sales_forecast.area, :name) %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.company %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.division %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.customer_name %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.instrument %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= number_with_delimiter(sales_forecast.price) %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= get_attribute(sales_forecast.budget, :name) %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= get_attribute(sales_forecast.certainty, :name) %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= expected_value(sales_forecast.price, get_attribute(sales_forecast.certainty, :name)) %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.reporting_date %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.fixed_date %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.order_date %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.agent %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= truncate(sales_forecast.condition, length: 20) %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.person_in_charge %></td>
        <td style="color: <%= get_attribute(sales_forecast.status, :color) %>"><%= sales_forecast.visible %></td>
        <td><%= link_to '詳細', sales_forecast %></td>
        <td><%= link_to '編集', edit_sales_forecast_path(sales_forecast) %></td>
        <td><%= link_to '削除', sales_forecast, method: :delete, data: { confirm: '削除しますか?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to '新規作成', {action: :new, sc: @service_center_id} %> | 
<%= link_to 'すべてを表示', {action: :index, show_all: "true", sc: @service_center_id} %>

